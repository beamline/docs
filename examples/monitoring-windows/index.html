
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../no-process-mining-as-input/" rel="prev"/>
<link href="../speech-recognition/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.18" name="generator"/>
<title>Monitoring active windows (for Windows systems) - Beamline Framework</title>
<link href="../../assets/stylesheets/main.7e37652d.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="default" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Beamline Framework" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Beamline Framework">
<img alt="logo" src="../../img/logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Beamline Framework
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Monitoring active windows (for Windows systems)
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/beamline/framework" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../getting-started/">
          
  
  
  Beamline

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../pybeamline/">
        
  
  
    
  
  pyBeamline

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../additional-libraries/">
          
  
  
  Additional libraries

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
          
  
  
  Examples

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../about/">
        
  
  
    
  
  About

      </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Beamline Framework" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Beamline Framework">
<img alt="logo" src="../../img/logo.svg"/>
</a>
    Beamline Framework
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/beamline/framework" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Beamline
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Beamline
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting-started/">
<span class="md-ellipsis">
    Getting started
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Implemented techniques
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
            Implemented techniques
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/">
<span class="md-ellipsis">
    Introduction
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Control-flow discovery
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_2_2">
<span class="md-nav__icon md-icon"></span>
            Control-flow discovery
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/discovery-trivial/">
<span class="md-ellipsis">
    Trivial Miner
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/discovery-heuristics-miner/">
<span class="md-ellipsis">
    Heuristics Miner
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/discovery-declare/">
<span class="md-ellipsis">
    Declare Miner
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/discovery-dcr/">
<span class="md-ellipsis">
    DCR Miner
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/discovery-soft/">
<span class="md-ellipsis">
    Soft Conformance Model Miner
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/discovery-splitminer/">
<span class="md-ellipsis">
    Split Miner
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
<span class="md-ellipsis">
    Conformance checking
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_2_3">
<span class="md-nav__icon md-icon"></span>
            Conformance checking
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/conformance-behavioural-patterns/">
<span class="md-ellipsis">
    Behavioural Patterns
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/conformance-soft/">
<span class="md-ellipsis">
    Soft Conformance
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
<span class="md-ellipsis">
    Simulation
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_2_4">
<span class="md-nav__icon md-icon"></span>
            Simulation
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../implemented-techniques/simulation-plg/">
<span class="md-ellipsis">
    Simulation with PLG
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../pybeamline/">
<span class="md-ellipsis">
    pyBeamline
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Additional libraries
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Additional libraries
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../additional-libraries/">
<span class="md-ellipsis">
    Introduction
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../mqtt-xes/">
<span class="md-ellipsis">
    MQTT-XES
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../simple-pnml/">
<span class="md-ellipsis">
    Simple PNML
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    Examples
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Examples
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Introduction
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
<span class="md-ellipsis">
    Beamline
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
            Beamline
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../no-process-mining-as-input/">
<span class="md-ellipsis">
    Raw data as input (non-process mining ready)
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Monitoring active windows (for Windows systems)
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../speech-recognition/">
<span class="md-ellipsis">
    Speech recognition
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../wikipedia-edits/">
<span class="md-ellipsis">
    Wikipedia edits
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../open-sky-monitoring/">
<span class="md-ellipsis">
    OpenSky monitoring
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
<span class="md-ellipsis">
    pyBeamline
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
            pyBeamline
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../pybeamline-full-cicle/">
<span class="md-ellipsis">
    pyBeamline full cycle
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../about/">
<span class="md-ellipsis">
    About
    
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>Monitoring active windows (for Windows systems)</h1>
<p>One possible usage of streaming process mining could involve the monitoring of the current system. One possible way of achieving this goal is to monitor the window currently active (i.e., with the focus) as a proxy for the application being used by the user<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<p>To achieve this goal it is possible to define a new <code>XesSource</code> which observes the windows currently active and, whenever there is a new window in focus, emits an event. To accomplish this goal, in the following we make use of the <a href="https://en.wikipedia.org/wiki/Java_Native_Access">JNA (Java Native Access) library</a> which gives us access to the native shared libraries of the operating system. To have access to the library we need, first of all, to include it in our Maven dependency:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nt">&lt;dependency&gt;</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>net.java.dev.jna<span class="nt">&lt;/groupId&gt;</span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>jna<span class="nt">&lt;/artifactId&gt;</span>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>5.10.0<span class="nt">&lt;/version&gt;</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="nt">&lt;/dependency&gt;</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="nt">&lt;dependency&gt;</span>
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>net.java.dev.jna<span class="nt">&lt;/groupId&gt;</span>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>jna-platform<span class="nt">&lt;/artifactId&gt;</span>
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>5.10.0<span class="nt">&lt;/version&gt;</span>
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></p>
<p>Once the library is include we can define the method that will return the name of the currently active window on the screen (this works and has been tested on Windows 10 Enterprise):</p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kd">class</span> <span class="nc">Informer</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getWindowName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">MAX_TITLE_LENGTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">        </span><span class="kt">char</span><span class="o">[]</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">char</span><span class="o">[</span><span class="n">MAX_TITLE_LENGTH</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">        </span><span class="n">HWND</span><span class="w"> </span><span class="n">hwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">User32</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">.</span><span class="na">GetForegroundWindow</span><span class="p">();</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">        </span><span class="n">User32</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">.</span><span class="na">GetWindowText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">MAX_TITLE_LENGTH</span><span class="p">);</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">        </span><span class="n">IntByReference</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IntByReference</span><span class="p">();</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">        </span><span class="n">User32</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">.</span><span class="na">GetWindowThreadProcessId</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">);</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">        </span><span class="n">HANDLE</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kernel32</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">.</span><span class="na">OpenProcess</span><span class="p">(</span>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">                </span><span class="n">Kernel32</span><span class="p">.</span><span class="na">PROCESS_QUERY_INFORMATION</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Kernel32</span><span class="p">.</span><span class="na">PROCESS_VM_READ</span><span class="p">,</span>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">                </span><span class="kc">false</span><span class="p">,</span>
<a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="w">                </span><span class="n">pid</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span>
<a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">        </span><span class="n">Psapi</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">.</span><span class="na">GetModuleBaseNameW</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">MAX_TITLE_LENGTH</span><span class="p">);</span>
<a href="#__codelineno-1-15" id="__codelineno-1-15" name="__codelineno-1-15"></a>
<a href="#__codelineno-1-16" id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Native</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<a href="#__codelineno-1-17" id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-1-18" id="__codelineno-1-18" name="__codelineno-1-18"></a>
<a href="#__codelineno-1-19" id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Psapi</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StdCallLibrary</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-1-20" id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="w">        </span><span class="nd">@SuppressWarnings</span><span class="p">(</span><span class="s">"deprecation"</span><span class="p">)</span>
<a href="#__codelineno-1-21" id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="w">        </span><span class="n">Psapi</span><span class="w"> </span><span class="n">INSTANCE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Psapi</span><span class="p">)</span><span class="w"> </span><span class="n">Native</span><span class="p">.</span><span class="na">loadLibrary</span><span class="p">(</span><span class="s">"Psapi"</span><span class="p">,</span><span class="w"> </span><span class="n">Psapi</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a href="#__codelineno-1-22" id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="w">        </span><span class="n">WinDef</span><span class="p">.</span><span class="na">DWORD</span><span class="w"> </span><span class="nf">GetModuleBaseNameW</span><span class="p">(</span><span class="n">HANDLE</span><span class="w"> </span><span class="n">hProcess</span><span class="p">,</span><span class="w"> </span><span class="n">HANDLE</span><span class="w"> </span><span class="n">hModule</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">[]</span><span class="w"> </span><span class="n">lpBaseName</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nSize</span><span class="p">);</span>
<a href="#__codelineno-1-23" id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-1-24" id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="p">}</span>
</code></pre></div>
The documentation on the system calls used here can be found on the MSDN documentation (here, for example, the documentation for the <a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getforegroundwindow"><code>GetForegroundWindow</code> function</a>).</p>
<p>With this information it is now possible to wrap the code in a proper source:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">WindowsWindowMonitorSource</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">BeamlineAbstractSource</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">   </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">POLLING_DELAY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="c1">// milliseconds between checks of the active window</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">   </span><span class="nd">@Override</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="n">SourceContext</span><span class="o">&lt;</span><span class="n">BEvent</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ctx</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">      </span><span class="n">Queue</span><span class="o">&lt;</span><span class="n">BEvent</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">      </span><span class="n">String</span><span class="w"> </span><span class="n">caseId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UUID</span><span class="p">.</span><span class="na">randomUUID</span><span class="p">().</span><span class="na">toString</span><span class="p">();</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">      </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Runnable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="w">         </span><span class="nd">@Override</span>
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="w">         </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">latestProcess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span><span class="p">;</span>
<a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="n">isRunning</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w">               </span><span class="n">String</span><span class="w"> </span><span class="n">currentProcess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getWindowName</span><span class="p">();</span>
<a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">currentProcess</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">currentProcess</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">latestProcess</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="w">                  </span><span class="n">latestProcess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentProcess</span><span class="p">;</span>
<a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="w">                  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="w">                     </span><span class="n">buffer</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">BEvent</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">"window"</span><span class="p">,</span><span class="w"> </span><span class="n">caseId</span><span class="p">,</span><span class="w"> </span><span class="n">currentProcess</span><span class="p">));</span>
<a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="w">                  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">EventException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="w">               </span><span class="p">}</span>
<a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a>
<a href="#__codelineno-2-23" id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="w">               </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-24" id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="w">                  </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">POLLING_DELAY</span><span class="p">);</span>
<a href="#__codelineno-2-25" id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="w">               </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>
<a href="#__codelineno-2-26" id="__codelineno-2-26" name="__codelineno-2-26"></a><span class="w">            </span><span class="p">}</span>
<a href="#__codelineno-2-27" id="__codelineno-2-27" name="__codelineno-2-27"></a><span class="w">         </span><span class="p">}</span>
<a href="#__codelineno-2-28" id="__codelineno-2-28" name="__codelineno-2-28"></a><span class="w">      </span><span class="p">}).</span><span class="na">start</span><span class="p">();</span>
<a href="#__codelineno-2-29" id="__codelineno-2-29" name="__codelineno-2-29"></a>
<a href="#__codelineno-2-30" id="__codelineno-2-30" name="__codelineno-2-30"></a><span class="w">      </span><span class="k">while</span><span class="p">(</span><span class="n">isRunning</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-31" id="__codelineno-2-31" name="__codelineno-2-31"></a><span class="w">         </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">isRunning</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">buffer</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-32" id="__codelineno-2-32" name="__codelineno-2-32"></a><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">100l</span><span class="p">);</span>
<a href="#__codelineno-2-33" id="__codelineno-2-33" name="__codelineno-2-33"></a><span class="w">         </span><span class="p">}</span>
<a href="#__codelineno-2-34" id="__codelineno-2-34" name="__codelineno-2-34"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRunning</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-35" id="__codelineno-2-35" name="__codelineno-2-35"></a><span class="w">            </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="na">getCheckpointLock</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-36" id="__codelineno-2-36" name="__codelineno-2-36"></a><span class="w">               </span><span class="n">BEvent</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">.</span><span class="na">poll</span><span class="p">();</span>
<a href="#__codelineno-2-37" id="__codelineno-2-37" name="__codelineno-2-37"></a><span class="w">               </span><span class="n">ctx</span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<a href="#__codelineno-2-38" id="__codelineno-2-38" name="__codelineno-2-38"></a><span class="w">            </span><span class="p">}</span>
<a href="#__codelineno-2-39" id="__codelineno-2-39" name="__codelineno-2-39"></a><span class="w">         </span><span class="p">}</span>
<a href="#__codelineno-2-40" id="__codelineno-2-40" name="__codelineno-2-40"></a><span class="w">      </span><span class="p">}</span>
<a href="#__codelineno-2-41" id="__codelineno-2-41" name="__codelineno-2-41"></a><span class="w">   </span><span class="p">}</span>
<a href="#__codelineno-2-42" id="__codelineno-2-42" name="__codelineno-2-42"></a><span class="p">}</span>
</code></pre></div>
The basic idea is to check every <code>POLLING_DELAY</code> milliseconds for the name of the window currently on focus and, if this has changed, then a new event is published.</p>
<p>An example run of the application utilizing the <a href="../../implemented-techniques/discovery-trivial/">Trivial Miner</a> and the following code:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">WindowsWindowMonitor</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">      </span><span class="n">StreamExecutionEnvironment</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="na">getExecutionEnvironment</span><span class="p">();</span>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">      </span><span class="n">env</span>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">         </span><span class="p">.</span><span class="na">addSource</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">WindowsWindowMonitorSource</span><span class="p">())</span>
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">         </span><span class="p">.</span><span class="na">keyBy</span><span class="p">(</span><span class="n">BEvent</span><span class="p">::</span><span class="n">getProcessName</span><span class="p">)</span>
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">         </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">DirectlyFollowsDependencyDiscoveryMiner</span><span class="p">().</span><span class="na">setModelRefreshRate</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="na">setMinDependency</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">         </span><span class="p">.</span><span class="na">addSink</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">SinkFunction</span><span class="o">&lt;</span><span class="n">ProcessMap</span><span class="o">&gt;</span><span class="p">(){</span>
<a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">ProcessMap</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">               </span><span class="n">value</span><span class="p">.</span><span class="na">generateDot</span><span class="p">().</span><span class="na">exportToSvg</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s">"src/main/resources/output/output.svg"</span><span class="p">));</span>
<a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">            </span><span class="p">};</span>
<a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">         </span><span class="p">});</span>
<a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="w">      </span><span class="n">env</span><span class="p">.</span><span class="na">execute</span><span class="p">();</span>
<a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="w">   </span><span class="p">}</span>
<a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="p">}</span>
</code></pre></div></p>
<p>Produces the following map:</p>
<figure>
<svg height="281px" viewbox="0.00 0.00 323.50 281.00" width="324px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g class="graph" id="graph0" transform="scale(1.0 1.0) rotate(0.0) translate(4.0 277.0)">
<title>G</title>
<polygon fill="white" points="-4,4 -4,-277 319.5,-277 319.5,4 -4,4" stroke="none"></polygon>
<!-- e3e9b1010&#45;99f2&#45;42f2&#45;9a8b&#45;b87c95a37494&#45;&gt;e886f2ff8&#45;9c79&#45;453a&#45;b67e&#45;a8ab38501ee0 -->
<g class="edge" id="e0cb93538-c36f-416d-a3a7-a12ce9b8df3d"><title>e3e9b1010-99f2-42f2-9a8b-b87c95a37494-&gt;e886f2ff8-9c79-453a-b67e-a8ab38501ee0</title>
<path d="M204,-151.5C204,-151.5 154.08,-127.834 114.952,-109.285" fill="none" stroke="#252526" stroke-width="9"></path>
<polygon fill="#252526" points="116.443,-105.634 110.238,-107.05 113.069,-112.75 116.443,-105.634" stroke="#252526" stroke-width="9"></polygon>
<text font-family="Arial" font-size="8.00" text-anchor="middle" x="158.5" y="-117.6"> 1.0 (1)</text>
</g>
<!-- e3e9b1010&#45;99f2&#45;42f2&#45;9a8b&#45;b87c95a37494&#45;&gt;ef91712ff&#45;1664&#45;431b&#45;9547&#45;561693db89c9 -->
<g class="edge" id="e95208fa4-1fa4-41a5-941c-eacff0041769"><title>e3e9b1010-99f2-42f2-9a8b-b87c95a37494-&gt;ef91712ff-1664-431b-9547-561693db89c9</title>
<path d="M204,-151.5C204,-151.5 172.653,-132.971 180,-115 180.487,-113.808 181.054,-112.639 181.686,-111.498" fill="none" stroke="#252526" stroke-width="9"></path>
<polygon fill="#252526" points="185.035,-113.569 184.411,-107.236 178.4,-109.327 185.035,-113.569" stroke="#252526" stroke-width="9"></polygon>
<text font-family="Arial" font-size="8.00" text-anchor="middle" x="193.5" y="-117.6"> 1.0 (1)</text>
</g>
<!-- e98d60a8f&#45;7389&#45;47c7&#45;aea3&#45;7b135deb82db&#45;&gt;e3e9b1010&#45;99f2&#45;42f2&#45;9a8b&#45;b87c95a37494 -->
<g class="edge" id="e45c99a84-b50f-4a79-b06b-e322d6628509"><title>e98d60a8f-7389-47c7-aea3-7b135deb82db-&gt;e3e9b1010-99f2-42f2-9a8b-b87c95a37494</title>
<path d="M227,-21.5C227,-21.5 257.48,-41.1689 267,-66 273.523,-83.0147 275.381,-90.8194 267,-107 262.583,-115.528 255.696,-122.77 248.07,-128.778" fill="none" stroke="#252526" stroke-width="9"></path>
<polygon fill="#252526" points="245.42,-125.842 243.769,-131.988 250.131,-132.153 245.42,-125.842" stroke="#252526" stroke-width="9"></polygon>
<text font-family="Arial" font-size="8.00" text-anchor="middle" x="285.5" y="-84.6"> 1.0 (1)</text>
</g>
<!-- e886f2ff8&#45;9c79&#45;453a&#45;b67e&#45;a8ab38501ee0&#45;&gt;e98d60a8f&#45;7389&#45;47c7&#45;aea3&#45;7b135deb82db -->
<g class="edge" id="edf90044f-5944-45a0-aa96-dc8d00ce9018"><title>e886f2ff8-9c79-453a-b67e-a8ab38501ee0-&gt;e98d60a8f-7389-47c7-aea3-7b135deb82db</title>
<path d="M69,-85.5C69,-85.5 128.14,-61.5448 174.055,-42.946" fill="none" stroke="#252526" stroke-width="9"></path>
<polygon fill="#252526" points="175.58,-46.5766 178.736,-41.0499 172.624,-39.2776 175.58,-46.5766" stroke="#252526" stroke-width="9"></polygon>
<text font-family="Arial" font-size="8.00" text-anchor="middle" x="171.5" y="-51.6"> 1.0 (1)</text>
</g>
<!-- e3c37b245&#45;6359&#45;445f&#45;b594&#45;77d60b1ea9c8&#45;&gt;e3e9b1010&#45;99f2&#45;42f2&#45;9a8b&#45;b87c95a37494 -->
<g class="edge" id="ece05f8f4-aab5-482a-9466-446784c855c3"><title>e3c37b245-6359-445f-b594-77d60b1ea9c8-&gt;e3e9b1010-99f2-42f2-9a8b-b87c95a37494</title>
<path d="M204,-217.5C204,-217.5 204,-196.451 204,-178.496" fill="none" stroke="#252526" stroke-width="9"></path>
<polygon fill="#252526" points="207.938,-178.05 204,-173.05 200.063,-178.05 207.938,-178.05" stroke="#252526" stroke-width="9"></polygon>
<text font-family="Arial" font-size="8.00" text-anchor="middle" x="217.5" y="-183.6"> 1.0 (1)</text>
</g>
<!-- ef91712ff&#45;1664&#45;431b&#45;9547&#45;561693db89c9&#45;&gt;e3e9b1010&#45;99f2&#45;42f2&#45;9a8b&#45;b87c95a37494 -->
<g class="edge" id="e963f7715-2ed9-4784-911d-9ca26e5aaf5e"><title>ef91712ff-1664-431b-9547-561693db89c9-&gt;e3e9b1010-99f2-42f2-9a8b-b87c95a37494</title>
<path d="M207,-87.5C207,-87.5 207.881,-107.802 207,-124 206.947,-124.971 206.884,-125.961 206.812,-126.96" fill="none" stroke="#252526" stroke-width="9"></path>
<polygon fill="#252526" points="202.884,-126.682 206.393,-131.992 210.732,-127.336 202.884,-126.682" stroke="#252526" stroke-width="9"></polygon>
<text font-family="Arial" font-size="8.00" text-anchor="middle" x="220.5" y="-117.6"> 1.0 (1)</text>
</g>
<!-- ef949dfe4&#45;9d22&#45;4d8e&#45;8a7a&#45;04df7737f67d&#45;&gt;e3c37b245&#45;6359&#45;445f&#45;b594&#45;77d60b1ea9c8 -->
<g class="edge" id="ebd0e2212-4726-4f61-81dc-0651204015b6"><title>ef949dfe4-9d22-4d8e-8a7a-04df7737f67d-&gt;e3c37b245-6359-445f-b594-77d60b1ea9c8</title>
<path d="M204,-267.5C204,-267.5 204,-255.872 204,-244.062" fill="none" stroke="#acb89c" stroke-dasharray="5,2" stroke-width="2"></path>
<polygon fill="#acb89c" points="205.75,-244.023 204,-239.023 202.25,-244.023 205.75,-244.023" stroke="#acb89c" stroke-width="2"></polygon>
<text font-family="Arial" font-size="8.00" text-anchor="middle" x="205.5" y="-249.6"> </text>
</g>
<!-- e3e9b1010&#45;99f2&#45;42f2&#45;9a8b&#45;b87c95a37494 -->
<g class="node" id="e3e9b1010-99f2-42f2-9a8b-b87c95a37494"><title>e3e9b1010-99f2-42f2-9a8b-b87c95a37494</title>
<path d="M256.5,-173C256.5,-173 151.5,-173 151.5,-173 145.5,-173 139.5,-167 139.5,-161 139.5,-161 139.5,-144 139.5,-144 139.5,-138 145.5,-132 151.5,-132 151.5,-132 256.5,-132 256.5,-132 262.5,-132 268.5,-138 268.5,-144 268.5,-144 268.5,-161 268.5,-161 268.5,-167 262.5,-173 256.5,-173" fill="#0b4971" stroke="black"></path>
<text fill="#ffffff" font-family="Arial" font-size="22.00" text-anchor="start" x="147.5" y="-152.4">eclipse.exe</text>
<text fill="#ffffff" font-family="Arial" font-size="14.00" text-anchor="start" x="256.5" y="-152.4"> </text>
<text fill="#ffffff" font-family="Arial" font-size="11.00" text-anchor="start" x="188" y="-139.2">1.0 (3)</text>
</g>
<!-- e98d60a8f&#45;7389&#45;47c7&#45;aea3&#45;7b135deb82db -->
<g class="node" id="e98d60a8f-7389-47c7-aea3-7b135deb82db"><title>e98d60a8f-7389-47c7-aea3-7b135deb82db</title>
<path d="M303.5,-41C303.5,-41 150.5,-41 150.5,-41 144.5,-41 138.5,-35 138.5,-29 138.5,-29 138.5,-12 138.5,-12 138.5,-6 144.5,-0 150.5,-0 150.5,-0 303.5,-0 303.5,-0 309.5,-0 315.5,-6 315.5,-12 315.5,-12 315.5,-29 315.5,-29 315.5,-35 309.5,-41 303.5,-41" fill="#8eb6cd" stroke="black"></path>
<text fill="#000000" font-family="Arial" font-size="22.00" text-anchor="start" x="146.5" y="-20.4">OUTLOOK.EXE</text>
<text fill="#000000" font-family="Arial" font-size="14.00" text-anchor="start" x="303.5" y="-20.4"> </text>
<text fill="#000000" font-family="Arial" font-size="11.00" text-anchor="start" x="208" y="-7.2">0.33 (1)</text>
</g>
<!-- e886f2ff8&#45;9c79&#45;453a&#45;b67e&#45;a8ab38501ee0 -->
<g class="node" id="e886f2ff8-9c79-453a-b67e-a8ab38501ee0"><title>e886f2ff8-9c79-453a-b67e-a8ab38501ee0</title>
<path d="M126,-107C126,-107 12,-107 12,-107 6,-107 0,-101 0,-95 0,-95 0,-78 0,-78 0,-72 6,-66 12,-66 12,-66 126,-66 126,-66 132,-66 138,-72 138,-78 138,-78 138,-95 138,-95 138,-101 132,-107 126,-107" fill="#8eb6cd" stroke="black"></path>
<text fill="#000000" font-family="Arial" font-size="22.00" text-anchor="start" x="8" y="-86.4">explorer.exe</text>
<text fill="#000000" font-family="Arial" font-size="14.00" text-anchor="start" x="126" y="-86.4"> </text>
<text fill="#000000" font-family="Arial" font-size="11.00" text-anchor="start" x="50" y="-73.2">0.33 (1)</text>
</g>
<!-- e3c37b245&#45;6359&#45;445f&#45;b594&#45;77d60b1ea9c8 -->
<g class="node" id="e3c37b245-6359-445f-b594-77d60b1ea9c8"><title>e3c37b245-6359-445f-b594-77d60b1ea9c8</title>
<path d="M259,-239C259,-239 149,-239 149,-239 143,-239 137,-233 137,-227 137,-227 137,-210 137,-210 137,-204 143,-198 149,-198 149,-198 259,-198 259,-198 265,-198 271,-204 271,-210 271,-210 271,-227 271,-227 271,-233 265,-239 259,-239" fill="#8eb6cd" stroke="black"></path>
<text fill="#000000" font-family="Arial" font-size="22.00" text-anchor="start" x="145" y="-218.4">chrome.exe</text>
<text fill="#000000" font-family="Arial" font-size="14.00" text-anchor="start" x="259" y="-218.4"> </text>
<text fill="#000000" font-family="Arial" font-size="11.00" text-anchor="start" x="185" y="-205.2">0.33 (1)</text>
</g>
<!-- ef91712ff&#45;1664&#45;431b&#45;9547&#45;561693db89c9 -->
<g class="node" id="ef91712ff-1664-431b-9547-561693db89c9"><title>ef91712ff-1664-431b-9547-561693db89c9</title>
<path d="M246,-107C246,-107 168,-107 168,-107 162,-107 156,-101 156,-95 156,-95 156,-78 156,-78 156,-72 162,-66 168,-66 168,-66 246,-66 246,-66 252,-66 258,-72 258,-78 258,-78 258,-95 258,-95 258,-101 252,-107 246,-107" fill="#8eb6cd" stroke="black"></path>
<text fill="#000000" font-family="Arial" font-size="22.00" text-anchor="start" x="164" y="-86.4">cmd.exe</text>
<text fill="#000000" font-family="Arial" font-size="14.00" text-anchor="start" x="246" y="-86.4"> </text>
<text fill="#000000" font-family="Arial" font-size="11.00" text-anchor="start" x="188" y="-73.2">0.33 (1)</text>
</g>
<!-- ef949dfe4&#45;9d22&#45;4d8e&#45;8a7a&#45;04df7737f67d -->
<g class="node" id="ef949dfe4-9d22-4d8e-8a7a-04df7737f67d"><title>ef949dfe4-9d22-4d8e-8a7a-04df7737f67d</title>
<ellipse cx="204" cy="-268.5" fill="#ced6bd" rx="4.5" ry="4.5" stroke="#595f45"></ellipse>
</g>
</g>
</svg>
</figure>
<p>The complete code of this example is available in the GitHub repository <a href="https://github.com/beamline/examples/tree/master/src/main/java/beamline/examples/windowsWindowMonitor">https://github.com/beamline/examples/tree/master/src/main/java/beamline/examples/windowsWindowMonitor</a>.</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:1">
<p>It is important to emphasize that the active window might not really be the one that the user is currently using. For example, a user might be reading a webpage in a browser or a PDF document or another text document while having active another window. <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2022-2025 Technical University of Denmark
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/beamline" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "toc.integrate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
<script src="https://unpkg.com/mermaid@8.13.5/dist/mermaid.min.js"></script>
</body>
</html>